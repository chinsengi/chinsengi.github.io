<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{&quot;hostname&quot;:&quot;chinsengi.github.io&quot;,&quot;root&quot;:&quot;&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;images&quot;,&quot;scheme&quot;:&quot;Gemini&quot;,&quot;version&quot;:&quot;8.5.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:false,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:false,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜索...&quot;,&quot;empty&quot;:&quot;没有找到任何搜索结果：${query}&quot;,&quot;hits_time&quot;:&quot;找到 ${hits} 个搜索结果（用时 ${time} 毫秒）&quot;,&quot;hits&quot;:&quot;找到 ${hits} 个搜索结果&quot;},&quot;path&quot;:&quot;&#x2F;search.xml&quot;,&quot;localsearch&quot;:{&quot;enable&quot;:true,&quot;trigger&quot;:&quot;auto&quot;,&quot;top_n_per_article&quot;:1,&quot;unescape&quot;:false,&quot;preload&quot;:false}}</script><script src="/js/config.js"></script>
<meta name="description" content="\[ \begin{equation} \def\pr{\text{\rm pr}} \def\sec{\text{\rm sect}} \def\R{\mathbb{R}} \def\N{\mathbb{N}} \def\C{\mathbb{C}} \def\Z{\mathbb{Z}} \def\H{\mathcal{H}} \def\beq{\begin{equation}}">
<meta property="og:type" content="article">
<meta property="og:title" content="Chinese Remainder Theorem">
<meta property="og:url" content="https://chinsengi.github.io/zh-CN/2021/06/30/Chinese-Remainder-Theorem/">
<meta property="og:site_name" content="sengi&#39;s journal">
<meta property="og:description" content="\[ \begin{equation} \def\pr{\text{\rm pr}} \def\sec{\text{\rm sect}} \def\R{\mathbb{R}} \def\N{\mathbb{N}} \def\C{\mathbb{C}} \def\Z{\mathbb{Z}} \def\H{\mathcal{H}} \def\beq{\begin{equation}}">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-07-01T02:05:38.000Z">
<meta property="article:modified_time" content="2021-07-18T07:26:27.000Z">
<meta property="article:author" content="sengi">
<meta property="article:tag" content="Competitive Programming">
<meta property="article:tag" content="Chinese Remainder Theorem">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://chinsengi.github.io/zh-CN/2021/06/30/Chinese-Remainder-Theorem/">



<script class="next-config" data-name="page" type="application/json">{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:false,&quot;isPost&quot;:true,&quot;lang&quot;:&quot;zh-CN&quot;,&quot;comments&quot;:true,&quot;permalink&quot;:&quot;https:&#x2F;&#x2F;chinsengi.github.io&#x2F;2021&#x2F;06&#x2F;30&#x2F;Chinese-Remainder-Theorem&#x2F;&quot;,&quot;path&quot;:&quot;zh-CN&#x2F;2021&#x2F;06&#x2F;30&#x2F;Chinese-Remainder-Theorem&#x2F;&quot;,&quot;title&quot;:&quot;Chinese Remainder Theorem&quot;}</script>

<script class="next-config" data-name="calendar" type="application/json">&quot;&quot;</script>
<title>Chinese Remainder Theorem | sengi's journal</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">sengi's journal</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-6"><a class="nav-link" href="#reference"><span class="nav-number">1.</span> <span class="nav-text">Reference</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">sengi</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">6</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://chinsengi.github.io/2021/06/30/Chinese-Remainder-Theorem/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="sengi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="sengi's journal">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Chinese Remainder Theorem
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-07-01 10:05:38" itemprop="dateCreated datePublished" datetime="2021-07-01T10:05:38+08:00">2021-07-01</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-07-18 15:26:27" itemprop="dateModified" datetime="2021-07-18T15:26:27+08:00">2021-07-18</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p><span class="math display">\[
\begin{equation}
\def\pr{\text{\rm pr}}
\def\sec{\text{\rm sect}}
\def\R{\mathbb{R}}
\def\N{\mathbb{N}}
\def\C{\mathbb{C}}
\def\Z{\mathbb{Z}}
\def\H{\mathcal{H}}
\def\beq{\begin{equation}}
\def\endeq{\end{equation}}
\def\lesim{\lesssim}
\def\mc{\mathcal}
\def\h{\mathcal{H}}
\newcommand{\bram}[1]{\begin{bmatrix}#1\end{bmatrix}}
\def\mn{M^{(n)}}
\def\lam{\lambda}
\def\wide{\widehat}
\def\uk{u^{(k_0)}}
\def\uo{u^{(0)}}
\def\pj{P^{(2)}}
\def\pii{P^{(1)}}
\def\pc{P^{Cone}}
\def\tx{\tilde x}
\DeclareMathOperator{\re}{Re}
\DeclareMathOperator{\sgn}{sgn}
\def\cplus{c\ci+}
\def\cmin{c\ci-}
\def\cplusmin{c\ci\pm}
\def\chiplus{\chi\ci+}
\def\chimin{\chi\ci-}
\def\chiplusmin{\chi\ci\pm}
\def\psiplus{\psi\ci+}
\def\psimin{\psi\ci-}
\def\psiplusmin{\psi\ci\pm}
\def\sigmaplus{\sigma\ci+}
\def\sigmamin{\sigma\ci-}
\def\sigmaplusmin{\sigma\ci\pm}
\def\bbone{\mathbbm 1}
\newcommand{\dil}{\text{\rm Dil}}
\newcommand{\spec}{\operatorname{spec}}
\newcommand{\ls}{\lesssim}
\newcommand{\sL}{\mathscr L}
\newcommand{\sJ}{\mathscr J}
\newcommand{\sK}{\mathscr K}
\newcommand{\wh}{\widehat}
\newcommand{\wt}{\widetilde}
\newcommand{\A}{\mathcal A}
\newcommand{\E}{\mathcal E}
\newcommand{\F}{\mathcal F}
\newcommand{\D}{\mathcal D}
\newcommand{\K}{\mathcal K}
\newcommand{\QQ}{\mathcal Q}
\newcommand{\RR}{\mathcal R}
\newcommand{\f}[2]{\frac{#1}{#2}}
\newcommand{\term}{c(z,r)F^\Psi_r(\cdot-z)}
\newcommand{\norm}[1]{ \left|  #1 \right| }
\newcommand{\abs}[1]{ \left|  #1 \right| }
\newcommand{\Norm}[1]{ \left\|  #1 \right\| }
\newcommand{\iff}{\Leftrightarrow}
\newcommand{\set}[1]{ \left\{ #1 \right\} }
\newcommand{\Be}{\begin{equation}}
\newcommand{\Ee}{\end{equation}}
\newcommand{\Bm}{\begin{multline}}
\newcommand{\Em}{\end{multline}}
\newcommand{\Bea}{\begin{eqnarray}}
\newcommand{\Eea}{\end{eqnarray}}
\newcommand{\Beas}{\begin{eqnarray*}}
\newcommand{\Eeas}{\end{eqnarray*}}
\newcommand{\Benu}{\begin{enumerate}}
\newcommand{\Eenu}{\end{enumerate}}
\newcommand{\Bi}{\begin{itemize}}
\newcommand{\Ei}{\end{itemize}}
\def\conv{\text{Conv}}
\def\tp{\tilde p}
\def\tq{\tilde q}
\def\crit{\text{\rm cr}}
\def\sparse{\text{\rm sp}}
\def\dyad{\text{\rm dyad}}
\def\mart{\text{dyad}}
\def\intslash{\rlap{\kern  .32em $\mspace {.5mu}\backslash$ }\int}
\def\qsl{\rlap{\kern  .32em $\mspace {.5mu}\backslash$ }\int_{Q_x}}
\def\Re{\operatorname{Re\,}}
\def\Im{\operatorname{Im\,}}
\def\mx
\def\mn
\def\vth{\vartheta}
\def\rn{\rr^{n}}
\def\rr{\mathbb R}
\def\Q{\mathbb Q}
\def\N{\mathbb N}
\def\complex{\mathbb C}
\def\emph#1{\it #1 }
\def\diam{\text{\rm  diam}}
\def\osc{\text{\rm osc}}
\def\ffB{\mathcal B}
\def\seq{\subseteq}
\def\Ga{\Gamma}
\def\ga{\gamma}
\def\Th{\Theta}
\def\prd{\text{\it prod}}
\def\parab{\text{\it parabolic}}
\def\eg{\it e.g. }
\def\cf{\it cf}
\def\Rn{\mathbb R^n}
\def\Rd{\mathbb R^d}
\def\sgn{\text{\rm sign }}
\def\rank{\text{\rm rank }}
\def\corank{\text{\rm corank }}
\def\coker{\text{\rm Coker }}
\def\loc{\text{\rm loc}}
\def\spec{\text{\rm spec}}
\def\comp{\text{comp}}
\def\Coi{C^\infty_0}
\def\dist{\text{\it dist}}
\def\diag{\text{\rm diag}}
\def\supp{text{\rm supp}}
\def\rad{\text{\it rad}}
\def\sph{\text{sph}}
\def\Lip{\text{\rm Lip}}
\def\ev{\text{\rm ev}}
\def\odd{\text{\rm odd}}
\def\inn#1#2{\langle#1,#2\rangle}
\def\biginn#1#2{\big\langle#1,#2\big\rangle}
\def\rta{\rightarrow}
\def\lta{\leftarrow}
\def\noi{\noindent}
\def\lcontr{\rfloor}
\newcommand{\pmtx}[1]{\begin{pmatrix}#1\end{pmatrix}}
\def\meas{\text{\rm meas}}
\def\card{\text{\rm card}}
\def\lc{\lesssim}
\def\gc{\gtrsim}
\def\pv{\text{\rm p.v.}}
\def\a{\alpha}
\def\alp{\alpha}             \def\Alp{\Alpha}
\def\bet{\beta}
\def\gam{\gamma}             \def\Gam{\Gamma}
\def\del{\delta}             \def\Del{\Delta}
\def\eps{\varepsilon}
\def\ep{\epsilon}
\def\zet{\zeta}
\def\tet{\theta}             \def\Tet{\Theta}
\def\iot{\iota}
\def\kap{\kappa}
\def\ka{\kappa}
\def\lam{\lambda}            \def\Lam{\Lambda}
\def\la{\lambda}             \def\La{\Lambda}
\def\sig{\sigma}             \def\Sig{\Sigma}
\def\si{\sigma}              \def\Si{\Sigma}
\def\vphi{\varphi}
\def\ome{\omega}             \def\Ome{\Omega}
\def\om{\omega}  
\def\fA{\mathfrak {A}}
\def\fB{\mathfrak {B}}
\def\fC{\mathfrak {C}}
\def\fD{\mathfrak {D}}
\def\fE{\mathfrak {E}}
\def\fF{\mathfrak {F}}
\def\fG{mathfrak {G}}
\def\fH{\mathfrak {H}}
\def\fI{\mathfrak {I}}
\def\fJ{\mathfrak {J}}
\def\fK{\mathfrak {K}}
\def\fL{\mathfrak {L}}
\def\fM{\mathfrak {M}}
\def\fN{\mathfrak {N}}
\def\fO{\mathfrak {O}}
\def\fP{\mathfrak {P}}
\def\fQ{\mathfrak {Q}}
\def\fR{\mathfrak {R}}
\def\fS{\mathfrak {S}}
\def\fT{\mathfrak {T}}
\def\fU{\mathfrak {U}}
\def\fV{\mathfrak {V}}
\def\fW{\mathfrak {W}}
\def\fX{\mathfrak {X}}
\def\fY{\mathfrak {Y}}
\def\fZ{\mathfrak {Z}}
\def\fa{\mathfrak {a}}
\def\fb{\mathfrak {b}}
\def\fc{\mathfrak {c}}
\def\fd{\mathfrak {d}}
\def\fe{\mathfrak {e}}
\def\ff{\mathfrak {f}}
\def\fg{\mathfrak {g}}
\def\fh{\mathfrak {h}}
\def\fj{\mathfrak {j}}
\def\fk{\mathfrak {k}}
\def\fl{\mathfrak {l}}
\def\fn{\mathfrak {n}}
\def\fo{\mathfrak {o}}
\def\fq{\mathfrak {q}}
\def\fr{\mathfrak {r}}
\def\fs{\mathfrak {s}}
\def\ft{\mathfrak {t}}
\def\fu{\mathfrak {u}}
\def\fv{\mathfrak {v}}
\def\fw{\mathfrak {w}}
\def\fx{\mathfrak {x}}
\def\fy{\mathfrak {y}}
\def\fz{\mathfrak {z}}
\def\bbA{\mathbb {A}}
\def\bbB{\mathbb {B}}
\def\bbC{\mathbb {C}}
\def\bbD{\mathbb {D}}
\def\bbE{\mathbb {E}}
\def\bbF{\mathbb {F}}
\def\bbG{\mathbb {G}}
\def\bbH{\mathbb {H}}
\def\bbI{\mathbb {I}}
\def\bbJ{\mathbb {J}}
\def\bbK{\mathbb {K}}
\def\bbL{\mathbb {L}}
\def\bbM{\mathbb {M}}
\def\bbN{\mathbb {N}}
\def\bbO{\mathbb {O}}
\def\bbP{\mathbb {P}}
\def\bbQ{\mathbb {Q}}
\def\bbR{\mathbb {R}}
\def\bbS{\mathbb {S}}
\def\bbT{\mathbb {T}}
\def\bbU{\mathbb {U}}
\def\bbV{\mathbb {V}}
\def\bbW{\mathbb {W}}
\def\bbX{\mathbb {X}}
\def\bbY{\mathbb {Y}}
\def\bbZ{\mathbb {Z}}
\def\cA{\mathcal {A}}
\def\cB{\mathcal {B}}
\def\cC{\mathcal {C}}
\def\cD{\mathcal {D}}
\def\cE{\mathcal {E}}
\def\cF{\mathcal {F}}
\def\cG{\mathcal {G}}
\def\cH{\mathcal {H}}
\def\cI{\mathcal {I}}
\def\cJ{\mathcal {J}}
\def\cK{\mathcal {K}}
\def\cL{\mathcal {L}}
\def\cM{\mathcal {M}}
\def\cN{\mathcal {N}}
\def\cO{\mathcal {O}}
\def\cP{\mathcal {P}}
\def\cQ{\mathcal {Q}}
\def\cR{\mathcal {R}}
\def\cS{\mathcal {S}}
\def\cT{\mathcal {T}}
\def\cU{\mathcal {U}}
\def\cV{\mathcal {V}}
\def\cW{\mathcal {W}}
\def\cX{\mathcal {X}}
\def\cY{\mathcal {Y}}
\def\cZ{\mathcal {Z}}
\def\tA{\widetilde{A}}
\def\tB{\widetilde{B}}
\def\tC{\widetilde{C}}
\def\tD{\widetilde{D}}
\def\tE{\widetilde{E}}
\def\tF{\widetilde{F}}
\def\tG{\widetilde{G}}
\def\tH{\widetilde{H}}
\def\tI{\widetilde{I}}
\def\tJ{\widetilde{J}}
\def\tK{\widetilde{K}}
\def\tL{\widetilde{L}}
\def\tM{\widetilde{M}}
\def\tN{\widetilde{N}}
\def\tO{\widetilde{O}}
\def\tP{\widetilde{P}}
\def\tQ{\widetilde{Q}}
\def\tR{\widetilde{R}}
\def\tS{\widetilde{S}}
\def\tT{\widetilde{T}}
\def\tU{\widetilde{U}}
\def\tV{\widetilde{V}}
\def\tW{\widetilde{W}}
\def\tX{\widetilde{X}}
\def\tY{\widetilde{Y}}
\def\tZ{\widetilde{Z}}
\def\tcA{\widetilde{\mathcal {A}}}
\def\tcB{\widetilde{\mathcal {B}}}
\def\tcC{\widetilde{\mathcal {C}}}
\def\tcD{\widetilde{\mathcal {D}}}
\def\tcE{\widetilde{\mathcal {E}}}
\def\tcF{\widetilde{\mathcal {F}}}
\def\tcG{\widetilde{\mathcal {G}}}
\def\tcH{\widetilde{\mathcal {H}}}
\def\tcI{\widetilde{\mathcal {I}}}
\def\tcJ{\widetilde{\mathcal {J}}}
\def\tcK{\widetilde{\mathcal {K}}}
\def\tcL{\widetilde{\mathcal {L}}}
\def\tcM{\widetilde{\mathcal {M}}}
\def\tcN{\widetilde{\mathcal {N}}}
\def\tcO{\widetilde{\mathcal {O}}}
\def\tcP{\widetilde{\mathcal {P}}}
\def\tcQ{\widetilde{\mathcal {Q}}}
\def\tcR{\widetilde{\mathcal {R}}}
\def\tcS{\widetilde{\mathcal {S}}}
\def\tcT{\widetilde{\mathcal {T}}}
\def\tcU{\widetilde{\mathcal {U}}}
\def\tcV{\widetilde{\mathcal {V}}}
\def\tcW{\widetilde{\mathcal {W}}}
\def\tcX{\widetilde{\mathcal {X}}}
\def\tcY{\widetilde{\mathcal {Y}}}
\def\tcZ{\widetilde{\mathcal {Z}}}
\def\tfA{\widetilde{\mathfrak {A}}}
\def\tfB{\widetilde{\mathfrak {B}}}
\def\tfC{\widetilde{\mathfrak {C}}}
\def\tfD{\widetilde{\mathfrak {D}}}
\def\tfE{\widetilde{\mathfrak {E}}}
\def\tfF{\widetilde{\mathfrak {F}}}
\def\tfG{\widetilde{\mathfrak {G}}}
\def\tfH{\widetilde{\mathfrak {H}}}
\def\tfI{\widetilde{\mathfrak {I}}}
\def\tfJ{\widetilde{\mathfrak {J}}}
\def\tfK{\widetilde{\mathfrak {K}}}
\def\tfL{\widetilde{\mathfrak {L}}}
\def\tfM{\widetilde{\mathfrak {M}}}
\def\tfN{\widetilde{\mathfrak {N}}}
\def\tfO{\widetilde{\mathfrak {O}}}
\def\tfP{\widetilde{\mathfrak {P}}}
\def\tfQ{\widetilde{\mathfrak {Q}}}
\def\tfR{\widetilde{\mathfrak {R}}}
\def\tfS{\widetilde{\mathfrak {S}}}
\def\tfT{\widetilde{\mathfrak {T}}}
\def\tfU{\widetilde{\mathfrak {U}}}
\def\tfV{\widetilde{\mathfrak {V}}}
\def\tfW{\widetilde{\mathfrak {W}}}
\def\tfX{\widetilde{\mathfrak {X}}}
\def\tfY{\widetilde{\mathfrak {Y}}}
\def\tfZ{\widetilde{\mathfrak {Z}}}
\def\Atil{\widetilde A}          \def\atil{\tilde a}
\def\Btil{\widetilde B}          \def\btil{\tilde b}
\def\Ctil{\widetilde C}          \def\ctil{\tilde c}
\def\Dtil{\widetilde D}          \def\dtil{\tilde d}
\def\Etil{\widetilde E}          \def\etil{\tilde e}
\def\Ftil{\widetilde F}          \def\ftil{\tilde f}
\def\Gtil{\widetilde G}          \def\gtil{\tilde g}
\def\Htil{\widetilde H}          \def\htil{\tilde h}
\def\Itil{\widetilde I}          \def\itil{\tilde i}
\def\Jtil{\widetilde J}          \def\jtil{\tilde j}
\def\Ktil{\widetilde K}          \def\ktil{\tilde k}
\def\Ltil{\widetilde L}          \def\ltil{\tilde l}
\def\Mtil{\widetilde M}          \def\mtil{\tilde m}
\def\Ntil{\widetilde N}          \def\ntil{\tilde n}
\def\Otil{\widetilde O}          \def\otil{\tilde o}
\def\Ptil{\widetilde P}          \def\ptil{\tilde p}
\def\Qtil{\widetilde Q}          \def\qtil{\tilde q}
\def\Rtil{\widetilde R}          \def\rtil{\tilde r}
\def\Stil{\widetilde S}          \def\stil{\tilde s}
\def\Ttil{\widetilde T}          \def\ttil{\tilde t}
\def\Util{\widetilde U}          \def\util{\tilde u}
\def\Vtil{\widetilde V}          \def\vtil{\tilde v}
\def\Wtil{\widetilde W}          \def\wtil{\tilde w}
\def\Xtil{\widetilde X}          \def\xtil{\tilde x}
\def\Ytil{\widetilde Y}          \def\ytil{\tilde y}
\def\Ztil{\widetilde Z}          \def\ztil{\tilde z}
\def\ahat{\hat a}          \def\Ahat{\widehat A}
\def\bhat{\hat b}          \def\Bhat{\widehat B}
\def\chat{\hat c}          \def\Chat{\widehat C}
\def\dhat{\hat d}          \def\Dhat{\widehat D}
\def\ehat{\hat e}          \def\Ehat{\widehat E}
\def\fhat{\hat f}          \def\Fhat{\widehat F}
\def\ghat{\hat g}          \def\Ghat{\widehat G}
\def\hhat{\hat h}          \def\Hhat{\widehat H}
\def\ihat{\hat i}          \def\Ihat{\widehat I}
\def\jhat{\hat j}          \def\Jhat{\widehat J}
\def\khat{\hat k}          \def\Khat{\widehat K}
\def\lhat{\hat l}          \def\Lhat{\widehat L}
\def\mhat{\hat m}          \def\Mhat{\widehat M}
\def\nhat{\hat n}          \def\Nhat{\widehat N}
\def\ohat{\hat o}          \def\Ohat{\widehat O}
\def\phat{\hat p}          \def\Phat{\widehat P}
\def\qhat{\hat q}          \def\Qhat{\widehat Q}
\def\rhat{\hat r}          \def\Rhat{\widehat R}
\def\shat{\hat s}          \def\Shat{\widehat S}
\def\that{\hat t}          \def\That{\widehat T}
\def\uhat{\hat u}          \def\Uhat{\widehat U}
\def\vhat{\hat v}          \def\Vhat{\widehat V}
\def\what{\hat w}          \def\What{\widehat W}
\def\xhat{\hat x}          \def\Xhat{\widehat X}
\def\yhat{\hat y}          \def\Yhat{\widehat Y}
\def\zhat{\hat z}          \def\Zhat{\widehat Z}
\def\be#1{\begin{equation}\label{ #1}}
\def\endeq{\end{equation}}
\def\endal{\end{align}}
\def\bas{\begin{align*}}
\def\eas{\end{align*}}
\def\bi{\begin{itemize}}
\def\ei{\end{itemize}}
\def\eps{\varepsilon}
\def\textbf#1{\bf #1}
\def\into{\hookrightarrow}
\newcommand{\inf}{\infty}
\newcommand{\os}[2]{\overset{#1}{#2}}
\newcommand{\ms}{(X, \cM, \mu)}
\newcommand{\salg}{\sig\text{-algebra}}
\newcommand{\ol}[1]{\overline{#1}}
\newcommand{\bij}{\mathrel{\hookrightarrow\hspace{-1.8ex}\to}}
\newcommand{\onto}{\twoheadrightarrow}
\newcommand{\id}{\text{id}}
\newcommand{\Stab}{\text{Stab}}
\def \bl {\backslash}
\def \sfin {\sig\text{-finite}}
\def \mum {\mu\text{-measurable}}
\def \emps {\varnothing}
\newcommand{\m}[1]{\boldsymbol{#1}}
\newcommand{\bs}[1]{\boldsymbol{#1}}
\newcommand{\Inf}{\text{inf}}
\newcommand{\wb}[1]{\overline{#1}}
\newcommand{\lto}{\longrightarrow}
\newcommand{\todo}[1]{\bf\color{red}{[ToDo]
\text{#1}}}
\newcommand{\char}[1]{\cX_{#1}}
\newcommand{\fp}{f^+}
\newcommand{\fm}{f^-}
\newcommand{\infm}{\text{inf}}
\newcommand{\onorm}[1]{\Norm{#1}_1}
\newcommand{\tnorm}[1]{\Norm{#1}_2}
\newcommand{\infn}[1]{\Norm{#1}_\inf}
\newcommand{\pnorm}[1]{\Norm{#1}_p}
\newcommand{\End}{\text{End}}
\newcommand{\Ob}{\text{Ob}}
\newcommand{\Hom}{\text{Hom}}
\newcommand{\intall}{\int_{-\inf}^{\inf}}
\newcommand{\intpmpi}{\int_{-\pi}^{\pi}}
\newcommand{\div}{\bigr|}
\newcommand{\when}{\biggr|}
\def \bsp {\begin{split}}
\def \esp {\end{split}}
\def \bc {\begin{cases}}
\def \ec {\end{cases}}
\newcommand{\sech}{\text{sech}}
\newcommand{\vectk}{\text{Vect}_\text{k}}
\newcommand{\top}{\text{Top}}
\newcommand{\grp}{\text{Grp}}
\newcommand{\pathx}{\text{Paths}_X}
\newcommand{\from}{\leftarrow}
\newcommand{\lfrom}{\longleftarrow}
\newcommand{\tofrom}[2]{\os{\xrightarrow{#1}}{\xleftarrow[#2]{}}}
\newcommand{\sym}{\text{Sym}}
\newcommand{\Set}{\text{Set}}
\newcommand{\zn}{\Z/n\Z}
\newcommand{\Mor}{\text{Mor}}
\newcommand{\acton}{\circlearrowright}
\DeclareMathOperator{\tr}{Tr}
\newcommand{\par}{\partial}
\newcommand{\Fun}{\text{Fun}}
\newcommand{\triv}{\text{triv}}
\newcommand{\zmnz}[1]{\Z/{#1}\Z}
\newcommand{\tl}{\triangleleft}
\newcommand{\paren}[1]{\left({#1}\right)}
\newcommand{\ceil}[1]{\lceil{#1}\rceil}
\newcommand{\floor}[1]{\lfloor{#1}\rfloor}
\newcommand{\mod}{\textrm{mod}}
\newcommand{\ndiv}{\nmid}
\end{equation}
\]</span></p>
<p>I recently decided to pick up competitive programming, not only
because I enjoy programming, but also because this is a fail safe for my
academic career. With the tension between China and US rises, any
Chinese research personnel in the US is bound to be persecuted in one
way or another (it already begins with the visa application). It will be
increasingly risky to put all the eggs in one basket. And the recent <a target="_blank" rel="noopener" href="https://www.universityworldnews.com/post.php?story=20210611084120155">Wenhua
Jiang Incident</a> further dims the light on the path to tenure in China
for many researchers. So in short, doing competitive programming is an
act of interest (pun intended).</p>
<p>So much gibberish, today we are going to talk about Chinese Remainder
Theorem, which basically says that given a set of coprime integers, and
we know the remainders of an unknown integer modulo those coprime
numbers, then the smallest such unknown number can be uniquely
determined. For a rigorous definition, see <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Chinese_remainder_theorem">wiki</a>.
The proof is quite simply, say the set of coprime numbers are <span class="math inline">\(n_1, n_2, \dots, n_k\)</span>, and <span class="math inline">\(N = \Pi_i n_i\)</span>. And the aforementioned
remainders are <span class="math inline">\(r_1, r_2, \dots,
r_k\)</span>. We only consider integers in the range <span class="math inline">\([1, N]\)</span>. The key observation is that if
two <em>different</em> numbers have the same set of remainders, the
absolute difference between them will be divisible by all <span class="math inline">\(n_i\)</span> s, and since the difference is capped
by <span class="math inline">\(N-1\)</span>, it is zero, contradiction!
Therefore a one-to-one correspondence can be established between each
integer within that range and a set of all possible remainders. Note
that the range of each <span class="math inline">\(r_i\)</span> is <span class="math inline">\([0, r_i-1]\)</span>, so both sides have the same
cardinality.</p>
<p>Now let's look at implementation of this theorem in competitive
programming. An example problem is <a target="_blank" rel="noopener" href="https://atcoder.jp/contests/abc193/tasks/abc193_e">here</a>. So
the problem is to solve the following set of congruence equations <span class="math display">\[
x \equiv a_1 \pmod{m_1}\\
x\equiv a_2 \pmod{m_2}
\]</span> which is equivalent to <span class="math display">\[
x = a_1+n_1 m_1 = a_2+n_2m_2
\]</span> for some integer <span class="math inline">\(n_1\)</span> and
<span class="math inline">\(n_2\)</span>, i.e. <span class="math display">\[
\beq
a_2 - a_1 = n_1m_1 - n_2m_2 \tag{1} \label{eq:1}
\end{equation}
\]</span> We can use extended Euclidean algorithm to solve for <span class="math inline">\(n_i\)</span> given <span class="math inline">\(m_i\)</span> in the following equation <span class="math display">\[
\beq
n_1m_1 - n_2m_2 = \gcd(m_1, m_2) := d \tag{2}\label{eq:2}
\endeq
\]</span> <em>Detour (please skip at will)</em>: There is a proof of
existence of an integer solution that I really like about the above
equation. Since we can divide both sides by <span class="math inline">\(\gcd(m_1, m_2)\)</span>, we can just deal with the
case <span class="math inline">\(n_1m_1 - n_2m_2 = 1\)</span> where
<span class="math inline">\(m_1\)</span> and <span class="math inline">\(m_2\)</span> are coprime to each other. Now here
is the clever proof: Let <span class="math inline">\(r\)</span> be the
smallest positive integer such that <span class="math inline">\(n_1m_1 -
n_2m_2 = r\)</span> has an integer solution. And we can express <span class="math inline">\(m_1\)</span> as multiple of <span class="math inline">\(r\)</span> plus a remainder term, i.e. <span class="math inline">\(m_1 = q_1r+r_1\)</span>. So the equation becomes
<span class="math display">\[
n_1m_1 - n_2m_2 = r = (m_1 - r_1)/q_1
\]</span> Some algebra shows that <span class="math inline">\((1-q_1n_1)m_1+n_2q_1m_2 = r_1\)</span>, note that
<span class="math inline">\(r_1\)</span>, as a remainder of division by
<span class="math inline">\(r\)</span>, is strictly smaller than <span class="math inline">\(r\)</span>. So there is only one possibility:
<span class="math inline">\(r_1 = 0\)</span>. So <span class="math inline">\(m_1\)</span> is actually a multiple of <span class="math inline">\(r\)</span> ! By symmetry, <span class="math inline">\(m_2\)</span> is a multiple of <span class="math inline">\(r\)</span> as well. However since <span class="math inline">\(m_1\)</span> and <span class="math inline">\(m_2\)</span> are coprime, $r $ can only be 1. Note
that this is effectively a proof of existence since such smallest <span class="math inline">\(r\)</span> must exist as everything here is
finite. <span class="math inline">\(\blacksquare\)</span></p>
<p>Now if <span class="math inline">\(d\ndiv a_1 - a_2\)</span>, then we
can already claim that the pair of congruent equations have no solution.
If otherwise, we can multiply both sides of <span class="math inline">\(\eqref{eq:2}\)</span> by <span class="math inline">\((a_2 - a_1)/d\)</span> to get <span class="math inline">\(\eqref{eq:1}\)</span>. For equation sets that
contain 3 or more equations, we can process and merge two of them at a
time</p>
<p>Coding time!</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="comment">//extended euler&#x27;s algorithm</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">gcd</span><span class="params">(ll a, ll b, ll&amp; d, ll&amp; x, ll&amp; y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!b)&#123;d  = a; x = <span class="number">1</span>; y = <span class="number">0</span>;&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;<span class="built_in">gcd</span>(b, a%b, d, y, x); y -= (a/b)*x;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">china</span><span class="params">(<span class="keyword">int</span> n, ll* a, ll* m)</span></span>&#123;</span><br><span class="line">	ll d,y,x = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">rep</span>(i,<span class="number">0</span>,n<span class="number">-1</span>)&#123;</span><br><span class="line">		<span class="built_in">gcd</span>(m[i],m[i+<span class="number">1</span>],d,x,y);</span><br><span class="line">		<span class="keyword">if</span>((a[i+<span class="number">1</span>] - a[i])%d!=<span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">		a[i+<span class="number">1</span>] = a[i]+((x*((a[i+<span class="number">1</span>] - a[i])/d))%(m[i+<span class="number">1</span>]/d))*m[i];</span><br><span class="line">		m[i+<span class="number">1</span>] = m[i]*(m[i+<span class="number">1</span>]/d);</span><br><span class="line">		a[i+<span class="number">1</span>] = a[i+<span class="number">1</span>]%m[i+<span class="number">1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	ll M = m[n<span class="number">-1</span>];</span><br><span class="line">	<span class="keyword">return</span> (a[n<span class="number">-1</span>]+M)%M;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The extended Euler's algorithm can be implemented by just two lines
of C++, pretty surprising, isn't it? One last thing to note, as there is
a 10^18 numeric limit in most competitive programming contest, we need
to handle the overflow problem using <span class="math inline">\(c(a\pmod{b})\equiv ca \pmod{cb}\)</span> in the
following line of code</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[i+<span class="number">1</span>] = a[i]+((x*((a[i+<span class="number">1</span>] - a[i])/d))%(m[i+<span class="number">1</span>]/d))*m[i];</span><br></pre></td></tr></table></figure>
<p>That's it, happy coding until next time!</p>
<h6 id="reference">Reference</h6>
<p>[<a target="_blank" rel="noopener" href="https://codeforces.com/blog/entry/61290">Tutorial] Chinese
Remainder Theorem - Codeforces</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Competitive-Programming/" rel="tag"># Competitive Programming</a>
              <a href="/tags/Chinese-Remainder-Theorem/" rel="tag"># Chinese Remainder Theorem</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/06/19/Limit-of-Binomial-Distribution/" rel="prev" title="Limit of Binomial Distribution">
                  <i class="fa fa-chevron-left"></i> Limit of Binomial Distribution
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/07/17/Sprague-Grundy-Theorem-and-the-Game-of-Nim/" rel="next" title="Sprague-Grundy Theorem and the Game of Nim">
                  Sprague-Grundy Theorem and the Game of Nim <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
  <div class="languages">
    <label class="lang-select-label">
      <i class="fa fa-language"></i>
      <span>简体中文</span>
      <i class="fa fa-angle-up" aria-hidden="true"></i>
    </label>
    <select class="lang-select" data-canonical="" aria-label="选择语言">
      
        <option value="en" data-href="/2021/06/30/Chinese-Remainder-Theorem/" selected="">
          English
        </option>
      
        <option value="zh-CN" data-href="/zh-CN/2021/06/30/Chinese-Remainder-Theorem/" selected="">
          简体中文
        </option>
      
    </select>
  </div>


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">sengi</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/third-party/search/local-search.js"></script>




  <script class="next-config" data-name="mermaid" type="application/json">{&quot;enable&quot;:true,&quot;theme&quot;:&quot;forest&quot;,&quot;js&quot;:{&quot;url&quot;:&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;mermaid@8.9.3&#x2F;dist&#x2F;mermaid.min.js&quot;,&quot;integrity&quot;:&quot;sha256-OyJHvRcZHaRR6Ig73ppxF4QXk8HzvfgTprRWkulCkfY&#x3D;&quot;}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{&quot;enable&quot;:true,&quot;tags&quot;:&quot;none&quot;,&quot;js&quot;:{&quot;url&quot;:&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;mathjax@3.1.4&#x2F;es5&#x2F;tex-mml-chtml.js&quot;,&quot;integrity&quot;:&quot;sha256-ncNI9OXOS5Ek4tzVYiOMmN&#x2F;KKCPZ6V0Cpv2P&#x2F;zHntiA&#x3D;&quot;}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{&quot;enable&quot;:true,&quot;github_id&quot;:&quot;chinsengi&quot;,&quot;repo&quot;:&quot;blog_comments&quot;,&quot;client_id&quot;:&quot;ff354edc0715e209d19a&quot;,&quot;client_secret&quot;:&quot;d2d0a69da72f2dc38de874155543486ced53da71&quot;,&quot;admin_user&quot;:&quot;chinsengi&quot;,&quot;proxy&quot;:&quot;https:&#x2F;&#x2F;cors-anywhere.azm.workers.dev&#x2F;https:&#x2F;&#x2F;github.com&#x2F;login&#x2F;oauth&#x2F;access_token&quot;,&quot;distraction_free_mode&quot;:false,&quot;language&quot;:null,&quot;js&quot;:{&quot;url&quot;:&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;gitalk@1.7.2&#x2F;dist&#x2F;gitalk.min.js&quot;,&quot;integrity&quot;:&quot;sha256-Pmj85ojLaPOWwRtlMJwmezB&#x2F;Qg8BzvJp5eTzvXaYAfA&#x3D;&quot;},&quot;path_md5&quot;:&quot;f226f259a66511b4a2215f6ecc178820&quot;}</script>
<script src="/js/third-party/comments/gitalk.js"></script>

</body>
</html>
